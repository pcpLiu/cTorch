\hypertarget{storage_8c}{}\doxysection{c\+Torch/storage.c File Reference}
\label{storage_8c}\index{cTorch/storage.c@{cTorch/storage.c}}
{\ttfamily \#include \char`\"{}c\+Torch/storage.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}c\+Torch/logger\+\_\+util.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}c\+Torch/mem\+\_\+util.\+h\char`\"{}}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
Include dependency graph for storage.\+c\+:
% FIG 0
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{storage_8c_a7f6a8776a222aade8e6562fb15724172}{cth\+\_\+impl\+\_\+new\+\_\+list\+\_\+item\+\_\+func}} (\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}})
\item 
\mbox{\hyperlink{storage_8c_aae567fd6a4cb9b21a43176728c5e5a69}{cth\+\_\+impl\+\_\+new\+\_\+list\+\_\+func}} (\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}})
\item 
\mbox{\hyperlink{storage_8c_a0472a629f71260bdc6fc019f59fdd4f5}{cth\+\_\+impl\+\_\+insert\+\_\+list\+\_\+func}} (\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}})
\item 
\mbox{\hyperlink{storage_8c_a4d52337af7dd58282abfa54e1137272f}{cth\+\_\+impl\+\_\+list\+\_\+contains\+\_\+data\+\_\+func}} (\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}})
\item 
\mbox{\hyperlink{storage_8c_ada54896b178c3e05c33c3d2c7df340ed}{cth\+\_\+impl\+\_\+list\+\_\+contains\+\_\+item\+\_\+func}} (\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}})
\item 
\mbox{\hyperlink{storage_8c_af89e4bae74bac228574b2c7501f340f1}{cth\+\_\+impl\+\_\+list\+\_\+at\+\_\+func}} (\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}})
\item 
\mbox{\hyperlink{storage_8c_ae552affb14588bc2a798de9576371f60}{cth\+\_\+impl\+\_\+list\+\_\+pop\+\_\+func}} (\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}})
\item 
\mbox{\hyperlink{storage_8c_ac68eb40d9d7defa3395fce41ea66b1d7}{cth\+\_\+impl\+\_\+free\+\_\+list\+\_\+func}} (\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}})
\item 
\mbox{\hyperlink{storage_8c_a4b5726fc025056d7c10dafde55205d7a}{cth\+\_\+impl\+\_\+free\+\_\+list\+\_\+deep\+\_\+func}} (\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}})
\item 
\mbox{\hyperlink{storage_8c_a68a94b4fd5359b1d9e71d35f79b47af2}{cth\+\_\+impl\+\_\+new\+\_\+array\+\_\+func}} (\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}})
\item 
\mbox{\hyperlink{storage_8c_a71cae01e7d2c0899c1ed1197d9fedca4}{cth\+\_\+impl\+\_\+array\+\_\+at\+\_\+func}} (\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}})
\item 
\mbox{\hyperlink{storage_8c_a25414045432750123c37e2d1ef98ca2f}{cth\+\_\+impl\+\_\+array\+\_\+set\+\_\+func}} (\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}})
\item 
\mbox{\hyperlink{storage_8c_a0b55c82ca9f58166add61dda1d8a2325}{cth\+\_\+impl\+\_\+free\+\_\+array\+\_\+deep\+\_\+func}} (\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}})
\item 
size\+\_\+t \mbox{\hyperlink{storage_8c_a392c6206bd7967a053c92aeec0dc5fc7}{cth\+\_\+tensor\+\_\+data\+\_\+size}} (const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$tensor)
\item 
void \mbox{\hyperlink{storage_8c_a7b6681a398e831601d47431a8c82b683}{C\+T\+H\+\_\+\+F\+O\+R\+C\+E\+\_\+\+T\+E\+N\+S\+O\+R\+\_\+\+D\+I\+M\+E\+N\+S\+I\+ON}} (\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$tensor, \mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}} $\ast$target\+\_\+dims, \mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}} target\+\_\+n\+\_\+dim)
\begin{DoxyCompactList}\small\item\em Check if tensor has target dimensions, fail if not. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{storage_8c_a23670c1d1ac70e261f2e553b14ac2516}{cth\+\_\+tensor\+\_\+name\+\_\+match}} (const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$tensor, const char $\ast$target\+\_\+name)
\item 
void \mbox{\hyperlink{storage_8c_ad9285fcefa4d82b9fae7770861cdcf32}{C\+T\+H\+\_\+\+F\+O\+R\+C\+E\+\_\+\+T\+E\+N\+S\+O\+R\+\_\+\+N\+A\+ME}} (const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$tensor, const char $\ast$target\+\_\+name)
\item 
void \mbox{\hyperlink{storage_8c_a9a31ab71fae8c88b317c34785d3acc44}{cth\+\_\+tensor\+\_\+set\+\_\+name}} (const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$tensor, const char $\ast$target\+\_\+name)
\item 
void $\ast$ \mbox{\hyperlink{storage_8c_a332a30e6d9d6393b6aecd2ba4efb3d08}{cth\+\_\+tensor\+\_\+ptr\+\_\+offset}} (const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$tensor, \mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}} n\+\_\+elements)
\item 
void \mbox{\hyperlink{consts_8h_ad7d837be8ea11a60ea35da351cb958e7}{struct\+\_\+deep\+\_\+free}}() \mbox{\hyperlink{storage_8c_a7fa3ae78d81460b7a187c7ddd021a379}{C\+T\+H\+Tensor\+Meta}} (\mbox{\hyperlink{structCTHTensorMeta}{C\+T\+H\+Tensor\+Meta}} $\ast$meta)
\item 
void \mbox{\hyperlink{consts_8h_ad7d837be8ea11a60ea35da351cb958e7}{struct\+\_\+deep\+\_\+free}}() \mbox{\hyperlink{storage_8c_aecc966bcdaaa0091356167be7438ef41}{C\+T\+H\+Tensor}} (const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$tensor)
\item 
void \mbox{\hyperlink{storage_8c_a9e2f448e30f5a6c44bd01aef650cb0fe}{C\+T\+H\+\_\+\+F\+O\+R\+C\+E\+\_\+\+T\+E\+N\+S\+O\+R\+\_\+\+N\+U\+M\+\_\+\+E\+L\+E\+M\+E\+N\+TS}} (const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$tensor, \mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}} target\+\_\+n)
\item 
void \mbox{\hyperlink{storage_8c_a86aa5239ccf3ecd11da155f88f01b8a2}{C\+T\+H\+\_\+\+F\+O\+R\+C\+E\+\_\+\+T\+E\+N\+S\+O\+R\+\_\+\+T\+Y\+P\+ES}} (const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$tensor, const \mbox{\hyperlink{consts_8h_a4b8846c2fb1629129ab48cd874d22355}{C\+T\+H\+\_\+\+T\+E\+N\+S\+O\+R\+\_\+\+D\+A\+T\+A\+\_\+\+T\+Y\+PE}} $\ast$types, \mbox{\hyperlink{generic__array_8h_ab65d5f828d04ccd28eef52253e8040d1}{cth\+\_\+array\+\_\+index\+\_\+t}} n\+\_\+types)
\item 
\mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}} \mbox{\hyperlink{storage_8c_aa8a9b8fe9a14220d74b7fe8e9b63aea6}{cth\+\_\+tensor\+\_\+reduce\+\_\+startoffset}} (const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$tensor, const \mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}} $\ast$index\+\_\+dims, \mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}} reduce\+\_\+dim)
\begin{DoxyCompactList}\small\item\em Get starting offset on reduce action for {\ttfamily reduce\+\_\+dim}. A tensor with dim \mbox{[}2, 3, 2, 4\mbox{]}, if reduce dim is 1 and index dims is \mbox{[}1, 1, 3\mbox{]}, the offset should be 31. ~\newline
This func is used in reduce operation to calcualte each reduce dim\textquotesingle{}s starting offset. \end{DoxyCompactList}\item 
\mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}} \mbox{\hyperlink{storage_8c_aa0d00806debb9472deb6a70a32e129c7}{cth\+\_\+tensor\+\_\+reduce\+\_\+inneroffset}} (const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$tensor, \mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}} reduce\+\_\+dim)
\begin{DoxyCompactList}\small\item\em Get inner reduced elements offset on reduce action for reduce\+\_\+dim\+\_\+i. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{storage_8c_afb2ee9af90adea1e7fed2d6b0ea8f34a}{cth\+\_\+tensor\+\_\+get\+\_\+reduce\+\_\+index}} (const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$tensor, \mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}} group\+\_\+index, \mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}} reduce\+\_\+dim, \mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}} $\ast$result)
\begin{DoxyCompactList}\small\item\em Generate reduce index list for target group. \end{DoxyCompactList}\item 
\mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}} \mbox{\hyperlink{storage_8c_a21504419a4446f283f19aa7292c7df86}{cth\+\_\+tensor\+\_\+after\+\_\+dim\+\_\+offset}} (const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$tensor, \mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}} after\+\_\+dim)
\begin{DoxyCompactList}\small\item\em Get offset after a dim. For tensor dim \mbox{[}2, 3, 4, 5\mbox{]} and after\+\_\+dim {\ttfamily 1}, the value will be {\ttfamily 4$\ast$5 = 20}. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{storage_8c_a7b6681a398e831601d47431a8c82b683}\label{storage_8c_a7b6681a398e831601d47431a8c82b683}} 
\index{storage.c@{storage.c}!CTH\_FORCE\_TENSOR\_DIMENSION@{CTH\_FORCE\_TENSOR\_DIMENSION}}
\index{CTH\_FORCE\_TENSOR\_DIMENSION@{CTH\_FORCE\_TENSOR\_DIMENSION}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{CTH\_FORCE\_TENSOR\_DIMENSION()}{CTH\_FORCE\_TENSOR\_DIMENSION()}}
{\footnotesize\ttfamily void C\+T\+H\+\_\+\+F\+O\+R\+C\+E\+\_\+\+T\+E\+N\+S\+O\+R\+\_\+\+D\+I\+M\+E\+N\+S\+I\+ON (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$}]{tensor,  }\item[{\mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}} $\ast$}]{target\+\_\+dims,  }\item[{\mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}}}]{target\+\_\+n\+\_\+dim }\end{DoxyParamCaption})}



Check if tensor has target dimensions, fail if not. 


\begin{DoxyParams}{Parameters}
{\em tensor} & tensor \\
\hline
{\em target\+\_\+dims} & target dims array \\
\hline
{\em target\+\_\+n\+\_\+dim} & target number of dims \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{storage_8c_ad9285fcefa4d82b9fae7770861cdcf32}\label{storage_8c_ad9285fcefa4d82b9fae7770861cdcf32}} 
\index{storage.c@{storage.c}!CTH\_FORCE\_TENSOR\_NAME@{CTH\_FORCE\_TENSOR\_NAME}}
\index{CTH\_FORCE\_TENSOR\_NAME@{CTH\_FORCE\_TENSOR\_NAME}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{CTH\_FORCE\_TENSOR\_NAME()}{CTH\_FORCE\_TENSOR\_NAME()}}
{\footnotesize\ttfamily void C\+T\+H\+\_\+\+F\+O\+R\+C\+E\+\_\+\+T\+E\+N\+S\+O\+R\+\_\+\+N\+A\+ME (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$}]{tensor,  }\item[{const char $\ast$}]{target\+\_\+name }\end{DoxyParamCaption})}

Check if given tensor has target name. F\+A\+I\+L\+\_\+\+E\+X\+IT if not match. \mbox{\Hypertarget{storage_8c_a9e2f448e30f5a6c44bd01aef650cb0fe}\label{storage_8c_a9e2f448e30f5a6c44bd01aef650cb0fe}} 
\index{storage.c@{storage.c}!CTH\_FORCE\_TENSOR\_NUM\_ELEMENTS@{CTH\_FORCE\_TENSOR\_NUM\_ELEMENTS}}
\index{CTH\_FORCE\_TENSOR\_NUM\_ELEMENTS@{CTH\_FORCE\_TENSOR\_NUM\_ELEMENTS}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{CTH\_FORCE\_TENSOR\_NUM\_ELEMENTS()}{CTH\_FORCE\_TENSOR\_NUM\_ELEMENTS()}}
{\footnotesize\ttfamily void C\+T\+H\+\_\+\+F\+O\+R\+C\+E\+\_\+\+T\+E\+N\+S\+O\+R\+\_\+\+N\+U\+M\+\_\+\+E\+L\+E\+M\+E\+N\+TS (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$}]{tensor,  }\item[{\mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}}}]{target\+\_\+n }\end{DoxyParamCaption})}

Check if given tensor has target no. of elements. F\+A\+I\+L\+\_\+\+E\+X\+IT if not match. \mbox{\Hypertarget{storage_8c_a86aa5239ccf3ecd11da155f88f01b8a2}\label{storage_8c_a86aa5239ccf3ecd11da155f88f01b8a2}} 
\index{storage.c@{storage.c}!CTH\_FORCE\_TENSOR\_TYPES@{CTH\_FORCE\_TENSOR\_TYPES}}
\index{CTH\_FORCE\_TENSOR\_TYPES@{CTH\_FORCE\_TENSOR\_TYPES}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{CTH\_FORCE\_TENSOR\_TYPES()}{CTH\_FORCE\_TENSOR\_TYPES()}}
{\footnotesize\ttfamily void C\+T\+H\+\_\+\+F\+O\+R\+C\+E\+\_\+\+T\+E\+N\+S\+O\+R\+\_\+\+T\+Y\+P\+ES (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$}]{tensor,  }\item[{const \mbox{\hyperlink{consts_8h_a4b8846c2fb1629129ab48cd874d22355}{C\+T\+H\+\_\+\+T\+E\+N\+S\+O\+R\+\_\+\+D\+A\+T\+A\+\_\+\+T\+Y\+PE}} $\ast$}]{types,  }\item[{\mbox{\hyperlink{generic__array_8h_ab65d5f828d04ccd28eef52253e8040d1}{cth\+\_\+array\+\_\+index\+\_\+t}}}]{n\+\_\+types }\end{DoxyParamCaption})}

Check if tensor has one of given types.

Arguments\+:
\begin{DoxyItemize}
\item tensor\+: tensor
\item types\+: array of types
\item n\+\_\+types\+: no. of types in array 
\end{DoxyItemize}\mbox{\Hypertarget{storage_8c_a71cae01e7d2c0899c1ed1197d9fedca4}\label{storage_8c_a71cae01e7d2c0899c1ed1197d9fedca4}} 
\index{storage.c@{storage.c}!cth\_impl\_array\_at\_func@{cth\_impl\_array\_at\_func}}
\index{cth\_impl\_array\_at\_func@{cth\_impl\_array\_at\_func}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{cth\_impl\_array\_at\_func()}{cth\_impl\_array\_at\_func()}}
{\footnotesize\ttfamily cth\+\_\+impl\+\_\+array\+\_\+at\+\_\+func (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}}}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{storage_8c_a25414045432750123c37e2d1ef98ca2f}\label{storage_8c_a25414045432750123c37e2d1ef98ca2f}} 
\index{storage.c@{storage.c}!cth\_impl\_array\_set\_func@{cth\_impl\_array\_set\_func}}
\index{cth\_impl\_array\_set\_func@{cth\_impl\_array\_set\_func}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{cth\_impl\_array\_set\_func()}{cth\_impl\_array\_set\_func()}}
{\footnotesize\ttfamily cth\+\_\+impl\+\_\+array\+\_\+set\+\_\+func (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}}}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{storage_8c_a0b55c82ca9f58166add61dda1d8a2325}\label{storage_8c_a0b55c82ca9f58166add61dda1d8a2325}} 
\index{storage.c@{storage.c}!cth\_impl\_free\_array\_deep\_func@{cth\_impl\_free\_array\_deep\_func}}
\index{cth\_impl\_free\_array\_deep\_func@{cth\_impl\_free\_array\_deep\_func}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{cth\_impl\_free\_array\_deep\_func()}{cth\_impl\_free\_array\_deep\_func()}}
{\footnotesize\ttfamily cth\+\_\+impl\+\_\+free\+\_\+array\+\_\+deep\+\_\+func (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}}}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{storage_8c_a4b5726fc025056d7c10dafde55205d7a}\label{storage_8c_a4b5726fc025056d7c10dafde55205d7a}} 
\index{storage.c@{storage.c}!cth\_impl\_free\_list\_deep\_func@{cth\_impl\_free\_list\_deep\_func}}
\index{cth\_impl\_free\_list\_deep\_func@{cth\_impl\_free\_list\_deep\_func}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{cth\_impl\_free\_list\_deep\_func()}{cth\_impl\_free\_list\_deep\_func()}}
{\footnotesize\ttfamily cth\+\_\+impl\+\_\+free\+\_\+list\+\_\+deep\+\_\+func (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}}}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{storage_8c_ac68eb40d9d7defa3395fce41ea66b1d7}\label{storage_8c_ac68eb40d9d7defa3395fce41ea66b1d7}} 
\index{storage.c@{storage.c}!cth\_impl\_free\_list\_func@{cth\_impl\_free\_list\_func}}
\index{cth\_impl\_free\_list\_func@{cth\_impl\_free\_list\_func}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{cth\_impl\_free\_list\_func()}{cth\_impl\_free\_list\_func()}}
{\footnotesize\ttfamily cth\+\_\+impl\+\_\+free\+\_\+list\+\_\+func (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}}}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{storage_8c_a0472a629f71260bdc6fc019f59fdd4f5}\label{storage_8c_a0472a629f71260bdc6fc019f59fdd4f5}} 
\index{storage.c@{storage.c}!cth\_impl\_insert\_list\_func@{cth\_impl\_insert\_list\_func}}
\index{cth\_impl\_insert\_list\_func@{cth\_impl\_insert\_list\_func}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{cth\_impl\_insert\_list\_func()}{cth\_impl\_insert\_list\_func()}}
{\footnotesize\ttfamily cth\+\_\+impl\+\_\+insert\+\_\+list\+\_\+func (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}}}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{storage_8c_af89e4bae74bac228574b2c7501f340f1}\label{storage_8c_af89e4bae74bac228574b2c7501f340f1}} 
\index{storage.c@{storage.c}!cth\_impl\_list\_at\_func@{cth\_impl\_list\_at\_func}}
\index{cth\_impl\_list\_at\_func@{cth\_impl\_list\_at\_func}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{cth\_impl\_list\_at\_func()}{cth\_impl\_list\_at\_func()}}
{\footnotesize\ttfamily cth\+\_\+impl\+\_\+list\+\_\+at\+\_\+func (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}}}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{storage_8c_a4d52337af7dd58282abfa54e1137272f}\label{storage_8c_a4d52337af7dd58282abfa54e1137272f}} 
\index{storage.c@{storage.c}!cth\_impl\_list\_contains\_data\_func@{cth\_impl\_list\_contains\_data\_func}}
\index{cth\_impl\_list\_contains\_data\_func@{cth\_impl\_list\_contains\_data\_func}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{cth\_impl\_list\_contains\_data\_func()}{cth\_impl\_list\_contains\_data\_func()}}
{\footnotesize\ttfamily cth\+\_\+impl\+\_\+list\+\_\+contains\+\_\+data\+\_\+func (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}}}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{storage_8c_ada54896b178c3e05c33c3d2c7df340ed}\label{storage_8c_ada54896b178c3e05c33c3d2c7df340ed}} 
\index{storage.c@{storage.c}!cth\_impl\_list\_contains\_item\_func@{cth\_impl\_list\_contains\_item\_func}}
\index{cth\_impl\_list\_contains\_item\_func@{cth\_impl\_list\_contains\_item\_func}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{cth\_impl\_list\_contains\_item\_func()}{cth\_impl\_list\_contains\_item\_func()}}
{\footnotesize\ttfamily cth\+\_\+impl\+\_\+list\+\_\+contains\+\_\+item\+\_\+func (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}}}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{storage_8c_ae552affb14588bc2a798de9576371f60}\label{storage_8c_ae552affb14588bc2a798de9576371f60}} 
\index{storage.c@{storage.c}!cth\_impl\_list\_pop\_func@{cth\_impl\_list\_pop\_func}}
\index{cth\_impl\_list\_pop\_func@{cth\_impl\_list\_pop\_func}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{cth\_impl\_list\_pop\_func()}{cth\_impl\_list\_pop\_func()}}
{\footnotesize\ttfamily cth\+\_\+impl\+\_\+list\+\_\+pop\+\_\+func (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}}}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{storage_8c_a68a94b4fd5359b1d9e71d35f79b47af2}\label{storage_8c_a68a94b4fd5359b1d9e71d35f79b47af2}} 
\index{storage.c@{storage.c}!cth\_impl\_new\_array\_func@{cth\_impl\_new\_array\_func}}
\index{cth\_impl\_new\_array\_func@{cth\_impl\_new\_array\_func}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{cth\_impl\_new\_array\_func()}{cth\_impl\_new\_array\_func()}}
{\footnotesize\ttfamily cth\+\_\+impl\+\_\+new\+\_\+array\+\_\+func (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}}}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{storage_8c_aae567fd6a4cb9b21a43176728c5e5a69}\label{storage_8c_aae567fd6a4cb9b21a43176728c5e5a69}} 
\index{storage.c@{storage.c}!cth\_impl\_new\_list\_func@{cth\_impl\_new\_list\_func}}
\index{cth\_impl\_new\_list\_func@{cth\_impl\_new\_list\_func}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{cth\_impl\_new\_list\_func()}{cth\_impl\_new\_list\_func()}}
{\footnotesize\ttfamily cth\+\_\+impl\+\_\+new\+\_\+list\+\_\+func (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}}}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{storage_8c_a7f6a8776a222aade8e6562fb15724172}\label{storage_8c_a7f6a8776a222aade8e6562fb15724172}} 
\index{storage.c@{storage.c}!cth\_impl\_new\_list\_item\_func@{cth\_impl\_new\_list\_item\_func}}
\index{cth\_impl\_new\_list\_item\_func@{cth\_impl\_new\_list\_item\_func}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{cth\_impl\_new\_list\_item\_func()}{cth\_impl\_new\_list\_item\_func()}}
{\footnotesize\ttfamily cth\+\_\+impl\+\_\+new\+\_\+list\+\_\+item\+\_\+func (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}}}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{storage_8c_a21504419a4446f283f19aa7292c7df86}\label{storage_8c_a21504419a4446f283f19aa7292c7df86}} 
\index{storage.c@{storage.c}!cth\_tensor\_after\_dim\_offset@{cth\_tensor\_after\_dim\_offset}}
\index{cth\_tensor\_after\_dim\_offset@{cth\_tensor\_after\_dim\_offset}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{cth\_tensor\_after\_dim\_offset()}{cth\_tensor\_after\_dim\_offset()}}
{\footnotesize\ttfamily \mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}} cth\+\_\+tensor\+\_\+after\+\_\+dim\+\_\+offset (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$}]{tensor,  }\item[{\mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}}}]{after\+\_\+dim }\end{DoxyParamCaption})}



Get offset after a dim. For tensor dim \mbox{[}2, 3, 4, 5\mbox{]} and after\+\_\+dim {\ttfamily 1}, the value will be {\ttfamily 4$\ast$5 = 20}. 


\begin{DoxyParams}{Parameters}
{\em tensor} & \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} \\
\hline
{\em after\+\_\+dim} & cth\+\_\+tensor\+\_\+dim\+\_\+t target dim \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
cth\+\_\+tensor\+\_\+dim\+\_\+t 
\end{DoxyReturn}
\mbox{\Hypertarget{storage_8c_a392c6206bd7967a053c92aeec0dc5fc7}\label{storage_8c_a392c6206bd7967a053c92aeec0dc5fc7}} 
\index{storage.c@{storage.c}!cth\_tensor\_data\_size@{cth\_tensor\_data\_size}}
\index{cth\_tensor\_data\_size@{cth\_tensor\_data\_size}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{cth\_tensor\_data\_size()}{cth\_tensor\_data\_size()}}
{\footnotesize\ttfamily size\+\_\+t cth\+\_\+tensor\+\_\+data\+\_\+size (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$}]{tensor }\end{DoxyParamCaption})}

Get tensor\textquotesingle{}s data type size.

Note\+: alignment is N\+OT included. \mbox{\Hypertarget{storage_8c_afb2ee9af90adea1e7fed2d6b0ea8f34a}\label{storage_8c_afb2ee9af90adea1e7fed2d6b0ea8f34a}} 
\index{storage.c@{storage.c}!cth\_tensor\_get\_reduce\_index@{cth\_tensor\_get\_reduce\_index}}
\index{cth\_tensor\_get\_reduce\_index@{cth\_tensor\_get\_reduce\_index}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{cth\_tensor\_get\_reduce\_index()}{cth\_tensor\_get\_reduce\_index()}}
{\footnotesize\ttfamily void cth\+\_\+tensor\+\_\+get\+\_\+reduce\+\_\+index (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$}]{tensor,  }\item[{\mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}}}]{group\+\_\+index,  }\item[{\mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}}}]{reduce\+\_\+dim,  }\item[{\mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}} $\ast$}]{result }\end{DoxyParamCaption})}



Generate reduce index list for target group. 


\begin{DoxyParams}{Parameters}
{\em tensor} & Tensor \\
\hline
{\em group\+\_\+index} & Which reduce group \\
\hline
{\em reduce\+\_\+dim} & Which dim to reduce. If value is {\ttfamily -\/1}, flatten process \\
\hline
{\em result} & Result index list array \\
\hline
\end{DoxyParams}
Convert from group\+\_\+index to reduce index list\+:
\begin{DoxyItemize}
\item From biggest dimension to smallest dimension
\item On each dimension, do div
\end{DoxyItemize}\mbox{\Hypertarget{storage_8c_a23670c1d1ac70e261f2e553b14ac2516}\label{storage_8c_a23670c1d1ac70e261f2e553b14ac2516}} 
\index{storage.c@{storage.c}!cth\_tensor\_name\_match@{cth\_tensor\_name\_match}}
\index{cth\_tensor\_name\_match@{cth\_tensor\_name\_match}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{cth\_tensor\_name\_match()}{cth\_tensor\_name\_match()}}
{\footnotesize\ttfamily bool cth\+\_\+tensor\+\_\+name\+\_\+match (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$}]{tensor,  }\item[{const char $\ast$}]{target\+\_\+name }\end{DoxyParamCaption})}

Check if a tensor\textquotesingle{}s name match target name. \mbox{\Hypertarget{storage_8c_a332a30e6d9d6393b6aecd2ba4efb3d08}\label{storage_8c_a332a30e6d9d6393b6aecd2ba4efb3d08}} 
\index{storage.c@{storage.c}!cth\_tensor\_ptr\_offset@{cth\_tensor\_ptr\_offset}}
\index{cth\_tensor\_ptr\_offset@{cth\_tensor\_ptr\_offset}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{cth\_tensor\_ptr\_offset()}{cth\_tensor\_ptr\_offset()}}
{\footnotesize\ttfamily void$\ast$ cth\+\_\+tensor\+\_\+ptr\+\_\+offset (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$}]{tensor,  }\item[{\mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}}}]{n\+\_\+elements }\end{DoxyParamCaption})}

Get the pointer address by offsetting gieven tensor\textquotesingle{}s ptr with given number of elements. \mbox{\Hypertarget{storage_8c_aa0d00806debb9472deb6a70a32e129c7}\label{storage_8c_aa0d00806debb9472deb6a70a32e129c7}} 
\index{storage.c@{storage.c}!cth\_tensor\_reduce\_inneroffset@{cth\_tensor\_reduce\_inneroffset}}
\index{cth\_tensor\_reduce\_inneroffset@{cth\_tensor\_reduce\_inneroffset}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{cth\_tensor\_reduce\_inneroffset()}{cth\_tensor\_reduce\_inneroffset()}}
{\footnotesize\ttfamily \mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}} cth\+\_\+tensor\+\_\+reduce\+\_\+inneroffset (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$}]{tensor,  }\item[{const \mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}}}]{reduce\+\_\+dim }\end{DoxyParamCaption})}



Get inner reduced elements offset on reduce action for reduce\+\_\+dim\+\_\+i. 


\begin{DoxyParams}{Parameters}
{\em tensor} & \\
\hline
{\em reduce\+\_\+dim} & \\
\hline
{\em reduce\+\_\+dim\+\_\+i} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
$\ast$ cth\+\_\+tensor\+\_\+dim\+\_\+t 
\end{DoxyReturn}
\mbox{\Hypertarget{storage_8c_aa8a9b8fe9a14220d74b7fe8e9b63aea6}\label{storage_8c_aa8a9b8fe9a14220d74b7fe8e9b63aea6}} 
\index{storage.c@{storage.c}!cth\_tensor\_reduce\_startoffset@{cth\_tensor\_reduce\_startoffset}}
\index{cth\_tensor\_reduce\_startoffset@{cth\_tensor\_reduce\_startoffset}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{cth\_tensor\_reduce\_startoffset()}{cth\_tensor\_reduce\_startoffset()}}
{\footnotesize\ttfamily \mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}} cth\+\_\+tensor\+\_\+reduce\+\_\+startoffset (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$}]{tensor,  }\item[{const \mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}} $\ast$}]{index\+\_\+dims,  }\item[{\mbox{\hyperlink{consts_8h_acc36bfe0d9496aa5573f4fd4f6cde518}{cth\+\_\+tensor\+\_\+dim\+\_\+t}}}]{reduce\+\_\+dim }\end{DoxyParamCaption})}



Get starting offset on reduce action for {\ttfamily reduce\+\_\+dim}. A tensor with dim \mbox{[}2, 3, 2, 4\mbox{]}, if reduce dim is 1 and index dims is \mbox{[}1, 1, 3\mbox{]}, the offset should be 31. ~\newline
This func is used in reduce operation to calcualte each reduce dim\textquotesingle{}s starting offset. 


\begin{DoxyParams}{Parameters}
{\em tensor} & Target tensor \\
\hline
{\em index\+\_\+dims} & Dim index t oreduce \\
\hline
{\em reduce\+\_\+dim} & Which dim to reduce \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
cth\+\_\+tensor\+\_\+dim\+\_\+t The ptr offset to act on 
\end{DoxyReturn}
\mbox{\Hypertarget{storage_8c_a9a31ab71fae8c88b317c34785d3acc44}\label{storage_8c_a9a31ab71fae8c88b317c34785d3acc44}} 
\index{storage.c@{storage.c}!cth\_tensor\_set\_name@{cth\_tensor\_set\_name}}
\index{cth\_tensor\_set\_name@{cth\_tensor\_set\_name}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{cth\_tensor\_set\_name()}{cth\_tensor\_set\_name()}}
{\footnotesize\ttfamily void cth\+\_\+tensor\+\_\+set\+\_\+name (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$}]{tensor,  }\item[{const char $\ast$}]{target\+\_\+name }\end{DoxyParamCaption})}

Set tensor\textquotesingle{}S name. This function directly overrides the tensor\textquotesingle{}s name.

Note\+: this function will copy {\ttfamily target\+\_\+name}. It is safe to release {\ttfamily target\+\_\+name} after calling. \mbox{\Hypertarget{storage_8c_aecc966bcdaaa0091356167be7438ef41}\label{storage_8c_aecc966bcdaaa0091356167be7438ef41}} 
\index{storage.c@{storage.c}!CTHTensor@{CTHTensor}}
\index{CTHTensor@{CTHTensor}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{CTHTensor()}{CTHTensor()}}
{\footnotesize\ttfamily void \mbox{\hyperlink{consts_8h_ad7d837be8ea11a60ea35da351cb958e7}{struct\+\_\+deep\+\_\+free}}() \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structCTHTensor}{C\+T\+H\+Tensor}} $\ast$}]{tensor }\end{DoxyParamCaption})}

Deep free a tensor. Function name follows pattern defined in \mbox{\hyperlink{list__d_8h}{list\+\_\+d.\+h}} If the tensor is a sharded one, function will not release value block.

Note\+: If pointer is N\+U\+LL, error raised and exit. \mbox{\Hypertarget{storage_8c_a7fa3ae78d81460b7a187c7ddd021a379}\label{storage_8c_a7fa3ae78d81460b7a187c7ddd021a379}} 
\index{storage.c@{storage.c}!CTHTensorMeta@{CTHTensorMeta}}
\index{CTHTensorMeta@{CTHTensorMeta}!storage.c@{storage.c}}
\doxysubsubsection{\texorpdfstring{CTHTensorMeta()}{CTHTensorMeta()}}
{\footnotesize\ttfamily void \mbox{\hyperlink{consts_8h_ad7d837be8ea11a60ea35da351cb958e7}{struct\+\_\+deep\+\_\+free}}() \mbox{\hyperlink{structCTHTensorMeta}{C\+T\+H\+Tensor\+Meta}} (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structCTHTensorMeta}{C\+T\+H\+Tensor\+Meta}} $\ast$}]{meta\+\_\+info }\end{DoxyParamCaption})}

Deep free a meta info.

Note\+: If pointer is N\+U\+LL, error raised and exit. 